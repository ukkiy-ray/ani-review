<div class="main">
  <div class="side-bar">
    <%= render "posts/side_bar" %>
  </div>
  <div class="main-wrapper">
    <div class="bread">
      <% breadcrumb :user, @user %>
      <%= breadcrumbs separator: " &rsaquo; " %>
    </div>
    <div class="main-container">
      <div class="main-title">
        <% if user_signed_in? && @user.id == current_user.id %>
          マイページ
        <% else %>
          <%= "#{@user.nickname}さんの投稿" %>
        <% end %>
      </div>
      <div class="post-wrap">
        <div class="count">
          <% if user_signed_in? && @user.id == current_user.id %>
            <%= "現在、あなたは#{@posts.count}件投稿しています。" %>
            <%= link_to(likes_user_path(@user.id), method: :get, class: "my-favorite") do %>
              <span class="fa fa-heart favorite-btn"></span><span class="favorite">いいねした投稿はこちら</span>
            <% end %>

          <% else %>
            <%= "#{@post_all.count}件の記事があります。" %>
          <% end %>
        </div>
        <% if @posts.present? %>
          <% @posts.each do |post| %>
            <div class="post">
              <div class="title">
                <%= link_to "#{post.title}", post_path(post.id), class: "link-to-show" %>
              </div>
              <div class="genre">
              <div class="upper-content">
                <div class="category">
                  <%= post.category.name %>
                </div>
                <ul class="tag">
                  <li class="tag-list">
                    <%post.tags.each do |tag| %>
                      #<%=tag.name%>
                    <%end%>
                  </li>
                </ul>
              </div>
              <div class="like-count">
                <% if user_signed_in? %>
                  <% if post.likes.find_by(user_id: current_user.id).present? %>
                    <%= link_to(post_like_path(post.id, post.likes.find_by(user_id: current_user.id, post_id: post.id).id), method: :delete, class: "likes") do %>
                      <span class="fa fa-heart unlike-btn"></span>
                    <% end %>
                    <%= "#{post.likes.count}" %>
                  <% else %>
                    <%= link_to(post_likes_path(post.id), method: :post, class: "likes") do %>
                      <span class="fa fa-heart like-btn"></span>
                    <% end %>
                    <%= "#{post.likes.count}" %>
                  <% end %>
                <% else %>
                  <span class="fa fa-heart unlike-btn"></span>
                  <%= "#{post.likes.count}" %>
                <% end %>
              </div>
            </div>
            </div>
          <% end %>
        <% else %>
          <div class="nothing">記事が存在しません。</div>
        <% end %>
        <%= link_to "トップページに戻る", root_path, class: "link_to_root" %>
      </div>
      <%= paginate @posts %>
    </div>
  </div>
</div>